(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages_category_page1-goodsModule-invitePoster"],{"06d2":function(e,t,a){var n=a("24fb");t=n(!1),t.push([e.i,'@charset "UTF-8";\n/**\n * 这里是uni-app内置的常用样式变量\n *\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\n *\n */\n/**\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\n *\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\n */\n/* 颜色变量 */\n/* 页面左右间距 */\n/* 行为相关颜色 */\n/* 文字基本颜色 */\n/* 背景颜色 */\n/* 边框颜色 */\n/* 尺寸变量 */\n/* 文字尺寸 */\n/*文字颜色*/\n/* 图片尺寸 */\n/* Border Radius */\n/* 水平间距 */\n/* 垂直间距 */\n/* 透明度 */\n/* 文章场景相关 */.qrcode[data-v-67ec1222]{padding:%?0?% 0 %?20?% 0;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-align:center;-webkit-align-items:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center}.title[data-v-67ec1222]{text-align:center}.canvas-box[data-v-67ec1222]{position:absolute;top:%?-88888?%}uni-page-body[data-v-67ec1222]{background-color:#f7f7f7}.invitePoster-box .bor-reu-8[data-v-67ec1222]{border-radius:%?8?%}.invitePoster-box .poster-box[data-v-67ec1222]{background-color:#fff;margin:%?30?% %?30?%;width:%?690?%;padding:%?40?% %?34?%;border-radius:%?8?%}.invitePoster-box .poster-box .header-img[data-v-67ec1222]{width:%?100?%;height:%?100?%;border-radius:50%}.invitePoster-box .poster-box .poster-img[data-v-67ec1222]{width:100%;height:%?414?%}.invitePoster-box .poster-box .title-lab[data-v-67ec1222]{width:%?400?%}.invitePoster-box .poster-box .spellNum[data-v-67ec1222]{background-color:#ffeddf;border-radius:%?22?%;width:%?144?%;height:%?44?%}.invitePoster-box .poster-box .code-img[data-v-67ec1222]{width:%?142?%;height:%?142?%}.invitePoster-box .poster-box .saveposter-but[data-v-67ec1222]{border-radius:%?5?%;background-color:#ff7800;color:#fff;width:%?420?%;height:%?66?%}body.?%PAGE?%[data-v-67ec1222]{background-color:#f7f7f7}',""]),e.exports=t},1650:function(e,t,a){"use strict";var n=a("ba11"),i=a.n(n);i.a},"3a6f":function(e,t,a){"use strict";a.r(t);var n=a("6d71"),i=a.n(n);for(var o in n)"default"!==o&&function(e){a.d(t,e,(function(){return n[e]}))}(o);t["default"]=i.a},"6d71":function(e,t,a){"use strict";(function(e){var n=a("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;n(a("bf63"));var i=a("f3ce"),o=a("9ae9"),s=a("ef67"),r={data:function(){return{data:{},canvasWidth:0,codeImg:"",codeImg2:"",headImage:"",image:"",qrcode:"",qrcodeimg:""}},onLoad:function(e){this.data=JSON.parse(e.data),this.getShare()},methods:{savePoster:function(t){if(1==t){uni.showLoading({title:"保存中..."});var a=this;setTimeout((function(){uni.canvasToTempFilePath({fileType:"png",quality:0,canvasId:"posterCanvas",success:function(e){uni.downloadFile({url:e.tempFilePath,success:function(t){400!==t.statusCode&&200!==t.statusCode||uni.saveImageToPhotosAlbum({filePath:e.tempFilePath,success:function(e){uni.hideLoading(),uni.showToast({title:"图片保存成功~",duration:2e3})},fail:function(e){"saveImageToPhotosAlbum:fail auth deny"===e.errMsg?(a.$store.dispatch("SetPhoneShow",1),uni.showToast({title:"保存失败，稍后再试",duration:2e3,icon:"none"})):uni.showToast({title:"保存失败，稍后再试",duration:2e3,icon:"none"}),uni.hideLoading()}})}})},fail:function(){uni.showToast({title:"保存失败，稍后再试",duration:2e3,icon:"none"}),uni.hideLoading()}})}),5e3)}else if(2==t){uni.showLoading({title:"图片生成中..."});setTimeout((function(){uni.canvasToTempFilePath({fileType:"png",quality:0,canvasId:"posterCanvas",success:function(e){uni.downloadFile({url:e.tempFilePath,success:function(e){200===e.statusCode&&(uni.hideLoading(),uni.showModal({title:"提示",content:"长按即可保存图片",confirmText:"确定",cancelText:"取消",success:function(t){t.confirm&&uni.previewImage({current:e.tempFilePath,urls:[e.tempFilePath]})}}))}})},fail:function(t){e.log(t.errMsg),uni.showToast({title:"保存失败，稍后再试",duration:2e3,icon:"none"})}})}),5e3)}},getShare:function(){var e=this;o.request(s.getShare,{collageId:this.data.collageId,orderId:this.data.orderId,productId:this.data.productId,skuId:this.data.skuId,type:0},"GET").then((function(t){e.qrcode=t.data.qrcode,e.getCanvas()})).catch((function(e){}))},getCanvas:function(){var e=this;uni.getImageInfo({src:e.data.headImage,success:function(t){e.headImage=t.path,uni.getImageInfo({src:e.data.image,success:function(t){e.image=t.path,uni.getImageInfo({src:e.qrcode,success:function(t){e.qrcodeimg=t.path,setTimeout((function(){var t=uni.createCanvasContext("posterCanvas");t.setFillStyle("#FFFFFF"),t.fillRect(15,0,820,1e3),e.drawRound(t,25,160,28,e.headImage),t.setFontSize(14),t.setFillStyle("#333333"),t.fillText("发现一件好物，快来和我一起拼",89,120),t.drawImage(e.image,25,150,310,200),t.setFontSize(14),t.setFillStyle("#333333"),t.fillText(e.data.productName,40,390),t.setFontSize(14),t.setFillStyle("#FF7800"),t.fillText(e.data.person+"人团",40,430),t.setFontSize(24),t.setFillStyle("#FF7800"),t.fillText("¥"+e.data.price,40,470),t.setFontSize(14),t.setFillStyle("#999999"),t.fillText("原价：¥"+e.data.originalPrice,120,468),t.drawImage(e.qrcodeimg,245,370,80,80),t.setFontSize(14),t.setStrokeStyle("#666666"),t.fillText("扫描二维码",250,468),t.draw()}),1500)}})}})}})},exportImg:function(){uni.canvasToTempFilePath({fileType:"jpg",canvasId:"couponQrcode",success:function(t){var a=this;(0,i.base64ToPath)(t.tempFilePath).then((function(e){a.codeImg=e})).catch((function(t){e.error(t)}))}})},drawRound:function(e,t,a,n,i){e.save();t=t;var o=2*t,s=a+t,r=n+t;e.arc(s,r,t,0,2*Math.PI),e.clip(),e.drawImage(i,a,n,o,o),e.restore()}}};t.default=r}).call(this,a("5a52")["default"])},"6dde":function(e,t,a){"use strict";a.r(t);var n=a("a5a9"),i=a("3a6f");for(var o in i)"default"!==o&&function(e){a.d(t,e,(function(){return i[e]}))}(o);a("1650");var s,r=a("f0c5"),c=Object(r["a"])(i["default"],n["b"],n["c"],!1,null,"67ec1222",null,!1,n["a"],s);t["default"]=c.exports},a5a9:function(e,t,a){"use strict";var n;a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return o})),a.d(t,"a",(function(){return n}));var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-uni-view",{staticClass:"invitePoster-box"},[a("v-uni-view",{staticClass:"poster-box flex-items-plus flex-column"},[a("v-uni-image",{staticClass:"header-img mar-top-10",attrs:{src:e.data.headImage}}),a("v-uni-label",{staticClass:"mar-top-30"},[e._v("发现一件好物，快来和我一起拼")]),a("v-uni-image",{staticClass:"poster-img mar-top-50",attrs:{src:e.data.image}}),a("v-uni-view",{staticClass:"flex-row-plus flex-sp-between mar-top-40"},[a("v-uni-view",{staticClass:"flex-column-plus"},[a("v-uni-label",{staticClass:"title-lab fs28"},[e._v(e._s(e.data.productName))]),a("v-uni-view",{staticClass:"spellNum flex-items-plus font-color-FF7800 mar-top-30 fs24"},[e._v(e._s(e.data.person)+"人团")]),a("v-uni-view",{staticClass:"flex-row-plus mar-top-20 flex-items"},[a("v-uni-label",{staticClass:"font-color-FF7800 fs24"},[e._v("¥")]),a("v-uni-label",{staticClass:"font-color-FF7800 fs36 mar-left-5"},[e._v(e._s(e.data.price))]),a("v-uni-label",{staticClass:"font-color-999 fs26 mar-left-20"},[e._v("原价：¥"+e._s(e.data.originalPrice))])],1)],1),a("v-uni-view",{staticClass:"flex-column-plus flex-items-plus"},[a("v-uni-image",{staticStyle:{width:"180upx",height:"180upx"},attrs:{src:e.qrcode}}),a("v-uni-label",{staticClass:"font-color-666"},[e._v("扫描二维码")])],1)],1),a("v-uni-view",{staticClass:"saveposter-but flex-items-plus mar-top-50",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.savePoster(2)}}},[e._v("预览海报")])],1),a("v-uni-view",{staticClass:"bor-reu-8 pad-bot-30 canvas-box"},[a("v-uni-canvas",{staticStyle:{width:"720rpx",height:"1000rpx"},attrs:{"canvas-id":"posterCanvas",id:"posterCanvas"}})],1)],1)},o=[]},ba11:function(e,t,a){var n=a("06d2");"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var i=a("4f06").default;i("bbf57fb0",n,!0,{sourceMap:!1,shadowMode:!1})},f3ce:function(e,t,a){"use strict";function n(e){if(0===e.indexOf("_www")||0===e.indexOf("_doc")||0===e.indexOf("_documents")||0===e.indexOf("_downloads"))return e;if(0===e.indexOf("file://"))return e;if(0===e.indexOf("/storage/emulated/0/"))return e;if(0===e.indexOf("/")){var t=plus.io.convertAbsoluteFileSystem(e);if(t!==e)return t;e=e.substr(1)}return"_www/"+e}a("c975"),a("ace4"),a("d3b7"),a("ac1f"),a("3ca3"),a("466d"),a("5319"),a("1276"),a("5cc6"),a("9a8c"),a("a975"),a("735e"),a("c1ac"),a("d139"),a("3a7b"),a("d5d6"),a("82f8"),a("e91f"),a("60bd"),a("5f96"),a("3280"),a("3fcc"),a("ca91"),a("25a1"),a("cd26"),a("3c5d"),a("2954"),a("649e"),a("219c"),a("170b"),a("b39a"),a("72f7"),a("ddb0"),a("2b3d"),Object.defineProperty(t,"__esModule",{value:!0}),t.pathToBase64=r,t.base64ToPath=c;var i=0;function o(){return Date.now()+String(i++)}function s(e,t){for(var a=e.split("."),n=t.split("."),i=!1,o=0;o<n.length;o++){var s=a[o]-n[o];if(0!==s){i=s>0;break}}return i}function r(e){return new Promise((function(t,a){if("object"===typeof window&&"document"in window){if("function"===typeof FileReader){var i=new XMLHttpRequest;return i.open("GET",e,!0),i.responseType="blob",i.onload=function(){if(200===this.status){var e=new FileReader;e.onload=function(e){t(e.target.result)},e.onerror=a,e.readAsDataURL(this.response)}},i.onerror=a,void i.send()}var o=document.createElement("canvas"),s=o.getContext("2d"),r=new Image;return r.onload=function(){o.width=r.width,o.height=r.height,s.drawImage(r,0,0),t(o.toDataURL()),o.height=o.width=0},r.onerror=a,void(r.src=e)}"object"!==typeof plus?"object"===typeof wx&&wx.canIUse("getFileSystemManager")?wx.getFileSystemManager().readFile({filePath:e,encoding:"base64",success:function(e){t("data:image/png;base64,"+e.data)},fail:function(e){a(e)}}):a(new Error("not support")):plus.io.resolveLocalFileSystemURL(n(e),(function(e){e.file((function(e){var n=new plus.io.FileReader;n.onload=function(e){t(e.target.result)},n.onerror=function(e){a(e)},n.readAsDataURL(e)}),(function(e){a(e)}))}),(function(e){a(e)}))}))}function c(e){return new Promise((function(t,a){if("object"===typeof window&&"document"in window){e=e.split(",");var n=e[0].match(/:(.*?);/)[1],i=atob(e[1]),r=i.length,c=new Uint8Array(r);while(r--)c[r]=i.charCodeAt(r);return t((window.URL||window.webkitURL).createObjectURL(new Blob([c],{type:n})))}var u=e.match(/data\:\S+\/(\S+);/);u?u=u[1]:a(new Error("base64 error"));var l=o()+"."+u;if("object"!==typeof plus)if("object"===typeof wx&&wx.canIUse("getFileSystemManager")){p=wx.env.USER_DATA_PATH+"/"+l;wx.getFileSystemManager().writeFile({filePath:p,data:e.replace(/^data:\S+\/\S+;base64,/,""),encoding:"base64",success:function(){t(p)},fail:function(e){a(e)}})}else a(new Error("not support"));else{var d="_doc",f="uniapp_temp",p=d+"/"+f+"/"+l;if(!s("Android"===plus.os.name?"1.9.9.80627":"1.9.9.80472",plus.runtime.innerVersion))return void plus.io.resolveLocalFileSystemURL(d,(function(n){n.getDirectory(f,{create:!0,exclusive:!1},(function(n){n.getFile(l,{create:!0,exclusive:!1},(function(n){n.createWriter((function(n){n.onwrite=function(){t(p)},n.onerror=a,n.seek(0),n.writeAsBinary(e.replace(/^data:\S+\/\S+;base64,/,""))}),a)}),a)}),a)}),a);var v=new plus.nativeObj.Bitmap(l);v.loadBase64Data(e,(function(){v.save(p,{},(function(){v.clear(),t(p)}),(function(e){v.clear(),a(e)}))}),(function(e){v.clear(),a(e)}))}}))}}}]);